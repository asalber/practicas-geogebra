% Author: Alfredo Sánchez Alberca (asalber@ceu.es)
\chapter{Ecuaciones Diferenciales Ordinarias}

% \section{Fundamentos teóricos}

% Muchos fenómenos de la naturaleza como la desintegración radiactiva, algunas reacciones químicas, el crecimiento de
% poblaciones o algunos problemas gravitatorios responden a determinadas ecuaciones en las que se relaciona una función
% con sus derivadas. 
% Este tipo de ecuaciones se conocen como \emph{ecuaciones diferenciales} y en esta práctica
% estudiaremos cómo resolverlas.

% \subsection{Ecuaciones diferenciales ordinarias (E.D.O.)}
% Se llama \emph{ecuación diferencial ordinaria (E.D.O.)} a una relación entre una variable independiente $x$, una función
% desconocida $y(x)$, y alguna de las derivadas de $y$ con respecto a $x$. 
% Esto es, a una expresión de la forma
% \[
% F(x,y,y',y'',...,y^{(n})=0.
% \]

% Llamaremos \emph{orden de la ecuación diferencial ordinaria} al mayor orden de las derivadas que aparezcan en la
% ecuación. 
% Así, la forma más general de una E.D.O. de primer orden es $F(x,y,y')=0$, que puede quedar de la forma $y'=G(x,y)$ si se
% puede despejar $y'$.

% \subsubsection*{Solución de una E.D.O.}
% Diremos que una función $f(x)$ es \emph{solución} o \emph{integral} de la EDO $F(x,y,y',y'',...,y^{(n})=0$, si al
% sustituir en ella $y$ y sus derivadas por $f(x)$ y sus derivadas respectivas, la ecuación se satisface, es decir
% $F(x,f(x),f'(x),f''(x),...,f^{(n}(x))=0$.

% En general una ecuación diferencial admite infinitas soluciones, y se limita su número imponiendo condiciones iniciales.

% \subsection{Ecuaciones diferenciales ordinarias de primer orden}
% Una ecuación diferencial ordinaria de primer orden es una ecuación de la forma
% \[
% y'=F(x,y).
% \]
% Esta es la forma estándar de escribir la ecuación, aunque a veces, también se suele representar en la forma diferencial como
% \[
% M(x,y)dx+N(x,y)dy=0.
% \]

% \subsubsection*{Soluciones general y particular de una E.D.O. de primer orden}
% Se llama \emph{solución general} o \emph{integral general} de una ecuación diferencial ordinaria de primer orden a una
% función $y=f(x,c)$, donde $c$ es una constante real, tal que para cada valor de $c$, la función $y=f(x,c)$ es una
% solución de la ecuación diferencial. 
% A esta solución así obtenida para un valor concreto de $c$ se le denomina \emph{solución particular} o \emph{integral
% particular} de la ecuación diferencial.

% En la práctica, la determinación de las constantes que conducen a una solución particular se realiza imponiendo ciertas
% condiciones iniciales en el problema, que son los valores que debe tomar la solución en determinados puntos. 
% Así, para una ecuación diferencial ordinaria de primer orden $y'=F(x,y)$, una condición inicial se expresaría de la
% forma $y(x_{0})=y_{0}$, y la solución particular sería una función $y=f(x)$ tal que $f'(x)=F(x,f(x))$, y $f(x_0)=y_0$.

% Por ejemplo, si consideramos la ecuación diferencial $y'=y$, resulta sencillo comprobar que su solución general es
% $f(x)=ce^x$, ya que $f'(x)=ce^x$ y se cumple la ecuación. 
% Si para esta misma ecuación tenemos la condición inicial $y(0)=1$, entonces, al imponer dicha condición a la solución
% general, se tiene $f(0)=ce^0=1$, de donde se deduce que $c=1$, y por tanto la solución particular sería $f(x)=e^x$.

% Geométricamente, la solución general de una ecuación diferencial de primer orden representa una familia de curvas,
% denominadas \emph{curvas integrales}, una para cada valor concreto asignado a la constante arbitraria. 
% En la figura~\ref{g:curvas integrales} se muestran las curvas integrales de la ecuación diferencial $y'=y$.

% \begin{figure}[h!]
% \begin{center}
% \scalebox{1}{\input{img/ecuaciones_diferenciales/curvas_integrales}}
% \caption{Familia de curvas integrales que son solución de la ecuación $y'=y$.}
% \label{g:curvas integrales}
% \end{center}
% \end{figure}

% \subsubsection*{Existencia y unicidad de soluciones}
% El siguiente teorema aporta una condición suficiente, aunque no necesaria, para la existencia y la unicidad de la
% solución de una ecuación diferencial ordinaria de primer orden.

% \begin{teoremasn}
% Si $F(x,y)$ y $\partial F/\partial y$ son funciones continuas en un entorno del punto $(x_0,y_0)$, entonces la ecuación
% diferencial $y'=F(x,y)$ tiene una solución $y=f(x)$ que verifica $f(x_0)=y_0$, y además esa solución es única.
% \end{teoremasn}
% Cuando no se cumplen las condiciones del teorema hay que tener cuidado porque la ecuación puede no tener solución, o
% bien tener soluciones múltiples como ocurre con la ecuación $y'=3\sqrt[3]{y^2}$, que tiene dos soluciones $y=0$ y
% $y=x^3$ que pasan por el punto $(0,0)$, ya que $\frac{\partial}{\partial y}(3\sqrt[3]{y^2})=2/\sqrt[3]{y}$ que no existe
% en $(0,0)$.

% Desafortunadamente, el teorema anterior sólo nos habla de la existencia de una solución pero no nos proporciona la forma
% de obtenerla. 
% En general, no existe una única técnica de resolución de ecuaciones diferenciales ordinarias de primer orden
% $M(x,y)dx+N(x,y)dy=0$, sino que dependiendo de la forma que tengan $M(x,y)$ y $N(x,y)$, se utilizan distintas técnicas.


% \subsection{EDO de variables separables}
% Una E.D.O. de primer orden es de \emph{variables separables} si se puede poner de la forma $y'g(y)=f(x)$ o bien
% $M(x)dx+N(y)dy=0$, donde $M(x)$ es una función que sólo depende de $x$ y $N(y)$ sólo depende de $y$.

% La solución de una ecuación de este tipo se obtiene fácilmente integrando $M(x)$ y $N(y)$ por separado, es decir
% \[
% \int M(x)\,dx=-\int N(y)\,dy.
% \]

% \subsection{EDO Homogéneas}
% Se dice que una función $F(x,y)$ es \emph{homogénea} de grado $n$ si se cumple $F(kx,ky)=k^nF(x,y)$.

% Una E.D.O. de primer orden es \emph{homogénea} si se puede poner de la forma
% $y'=f\left(\dfrac{y}{x}\right)$ o bien $M(x,y)dx+N(x,y)dy=0$ donde $M(x,y)$ y $N(x,y)$ son funciones homogéneas del mismo grado.

% Las ecuaciones homogéneas son fácilmente reducibles a ecuaciones de variables separables mediante el cambio $y=ux$,
% siendo $u$ una función derivable de $x$.

% \subsection{EDO Lineales}
% Una E.D.O. de primer orden es \emph{lineal} si se puede poner de la forma $y'+ P(x)y = Q(x)$, donde $P$ y $Q$ son
% funciones continuas de $x$.

% Para resolver este tipo de ecuaciones se utiliza la técnica de los factores integrantes. 
% Un factor integrante es una función $u(x)$ cuya derivada sea $P(x)u(x)$, con lo que al multiplicar $u(x)$ por el lado
% izquierdo de la ecuación, el resultado es la derivada del producto $u(x)y$, es decir
% \[
% u(x)y'+u(x)P(x)y=\frac{d}{dx}(u(x)y).
% \]
% A partir de aquí, si también multiplicamos por $u(x)$ el lado derecho de la ecuación tenemos
% \[
% \frac{d}{dx}(u(x)y)=Q(x)u(x),
% \]
% por lo que integrando, resulta
% \[
% u(x)y=\int Q(x)u(x)\,dx
% \]
% de donde se puede despejar fácilmente $y$.

% Por último, resulta fácil comprobar que un factor integrante de esta ecuación es $u(x)=e^{\int P(x)\, dx}$, de manera
% que la solución quedaría
% \[
% y=e^{-\int P(x)\,dx}\int Q(x)e^{\int P(x)\,dx}\,dx+C.
% \]

% \newpage

\section{Ejercicios resueltos}

\begin{enumerate}[leftmargin=*]
\item Resolver las siguientes ecuaciones diferenciales de variables separables y dibujar sus curvas integrales para distintos valores de la constante de integración.
      \begin{enumerate}
      \item $xdy=ydx$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(y'=y/x)} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \item Para hacer variar la constante de integración y obtener diferentes soluciones particulares abrir la \field{Vista de Álgebra} y mover el deslizador correspondiente a la constante.
            \end{enumerate}
            \end{indication}

      \item $-2x(1+e^y)+e^y(1+x^{2})y'=0$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(-2x(1+e\^{}y)+e\^{}y(1+x\^{}2)y'=0)} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \item Para hacer variar la constante de integración y obtener diferentes soluciones particulares abrir la \field{Vista de Álgebra} y mover el deslizador correspondiente a la constante.
            \end{enumerate}
            \end{indication}

      \item $y-xy'=1+x^2y'$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(y-x*y'=1+x\^{}2*y')} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \item Para hacer variar la constante de integración y obtener diferentes soluciones particulares abrir la \field{Vista de Álgebra} y mover el deslizador correspondiente a la constante.
            \end{enumerate}
            \end{indication}
      \end{enumerate}


\item Resolver y representar gráficamente las siguientes ecuaciones diferenciales con las condiciones iniciales dadas.
      \begin{enumerate}
      \item $xdy=ydx$, con la condición inicial $y(1)=2$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(y'=y/x, (1,2))} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \end{enumerate}
            \end{indication}

      \item $x\sqrt{1-y^2}+y\sqrt{1-x^2} y'=0$, con la condición inicial $y(0)=1$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(x*sqrt(1-y\^{}2)+y*sqrt(1-x\^{}2)y'=0, (0,1))} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \end{enumerate}
            \end{indication}

      \item $s'+s\cos t=\seno t\cos t$ con la condición inicial $s(0)=1$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO(s'+s*cos(t)=sen(t)cos(t), s, t, (0,1))} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item Para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \end{enumerate}
            \end{indication}

      \item $(1+e^x)yy'=e^y$, con la condición inicial $y(0)=0$.
            \begin{indication}
            \begin{enumerate}
            \item Introducir el comando \command{ResuelveEDO((1+e\^{}x)yy'=e\^{}y, (0,0))} en la \field{Barra de Entrada} de la \field{Vista CAS}.
            \item En este caso, Geogegra no es capaz de encontrar la solución particular de esta ecuación, pero podemos intentar resolverla separando las variables e integrando.
            \item Tras separar las variables se tiene la igualdad $\frac{y}{e^y}dy = \frac{1}{1+e^x}dx$, de manera que sólo hay que integrar a cada lado.
                  Para ello introducir el comando \command{Integral(y/e\^{}y) = Integral(1/(1+e\^{}x))} en la \field{Barra de Entrada}.
            \item En la solución aparecen dos constantes $c_1$ y $c_2$, pero realmente se puede eliminar una pasándola al otro lado.
                  Para ello introducir el comando \command{Sustituye(\$, c\_{}1=c, c\_{}2=0)} en la \field{Barra de Entrada}.
            \item Para imponer la condición inicial introducir el comando \command{Sustituye(\$, x=0, y=0)} en la \field{Barra de Entrada}.
            \item Para obtener el valor de la constante, introducir el comando \command{Resuelve(\$)} en la \field{Barra de Entrada}.
            \item Para sustituir el valor de la constante en la solución particular introducir el comando \command{Sustituye(\$n, \$)} en la \field{Barra de Entrada}, donde \command{n} es el número de la fila donde aparece la solución particular de la ecuación.
            \item Finalmente, para dibujar la solución de la ecuación diferencial, hacer clic en el círculo que aparece a la izquierda de la expresión anterior.
            \end{enumerate}
            \end{indication}
      \end{enumerate}


\item El azúcar se disuelve en el agua con una velocidad proporcional a la cantidad que queda por disolver.
      Si inicialmente había $13.6$ kg de azúcar y al cabo de $4$ horas quedan sin disolver $4.5$ kg, ¿cuánto tardará en disolverse el $95\%$ del
      azúcar contando desde el instante inicial?
      \begin{indication}
      \begin{enumerate}
      \item La ecuación diferencial que explica la disolución del azúcar es $a'=ka$, donde $a$ es la cantidad de azúcar que queda por disolver, $t$ es el tiempo y $k$ es la constante de disolución del azúcar.
      \item Para resolver la ecuación diferencial introducir el comando \command{ResuelveEDO(a'=k*a, a, t, (0, 13.6)} en la \field{Barra de Entrada} de la \field{Vista CAS}.
      \item Para imponer la segunda condición inicial introducir el comando \command{Sustituye(\$, t=4, a=4.5)} en la \field{Barra de Entrada}.
      \item Para obtener el valor de la constante de disolución introducir el comando \command{Resuelve(\$)} en la \field{Barra de Entrada}.
      \item Para sustituir el valor de la constante de disolución en la solución particular introducir el comando  \command{Sustituye(\$$n$,\$)} en la \field{Barra de Entrada}, donde $n$ es el número de la fila que contiene la solución particular de la ecuación diferencial.
      \item El azúcar que quedará sin disolver tras disolverse el 95\% de la cantidad inicial es el 5\% de esta cantidad.
            Para sustituir esta cantidad de azúcar en la solución de la ecuación diferencial introducir el comando \command{Sustituye(\$,13.6*0.05)} en la \field{Barra de Entrada}.
      \item Finalmente, para obtener la predicción del tiempo introducir el comando  \command{Resuelve(\$)} en la \field{Barra de Entrada}.
      \end{enumerate}
      \end{indication}

\end{enumerate}


\section{Ejercicios propuestos}
\begin{enumerate}[leftmargin=*]

\item Resolver las siguientes ecuaciones diferenciales:
      \begin{enumerate}
      \item $(1+y^{2})+xyy'=0$.
      \item $xy'-4y+2x^2+4=0$.
      \item $(y^{2}+xy^{2})y'+x^{2}-yx^{2}=0$.
      \item $(x^3-y^3)dx+2x^2ydy=0$.
      \item $(x^2+y^2+x)+xydy=0$.
      \end{enumerate}

\item Hallar las curvas tales que en cada punto $(x,y)$ la pendiente de la recta tangente sea igual al cubo de la
      abscisa en dicho punto.
      ¿Cuál de estas curvas pasa por el origen?

\item Al introducir glucosa por vía intravenosa a velocidad constante, el cambio de concentración global de glucosa con
      respecto al tiempo $c(t)$ se explica mediante la siguiente ecuación diferencial
      \[
      \frac{dc}{dt}=\frac{G}{100V}-kc,
      \]
      donde $G$ es la velocidad constante a la que se suministra la glucosa, $V$ es el volumen total de la sangre en el cuerpo y $k$ es una constante positiva que depende del paciente. Se pide calcular $c(t)$.

\item En una reacción química, un cierto compuesto se transforma en otra sustancia a un ritmo proporcional a la cantidad
      no transformada.
      Si había inicialmente 100 gr de sustancia original y 60 gr tras una hora, ¿cuanto tiempo pasará hasta
      que se haya transformado el 80\% del compuesto?
\end{enumerate}

