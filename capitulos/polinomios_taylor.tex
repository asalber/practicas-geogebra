% Author: Alfredo Sánchez Alberca (asalber@ceu.es)
\chapter{Polinomios de Taylor}

\section{Fundamentos teóricos}
A veces, las funciones elementales como las trigonométricas, las exponenciales y las logarítmicas, o composiciones de
las mismas, son difíciles de tratar y suelen aproximarse mediante polinomios que son funciones mucho más simples y con
muy buenas propiedades, ya que son continuas y derivables (a cualquier orden) en todos los reales.

\subsection{Polinomios de Taylor de funciones de una variable}
\begin{definicion}[Polinomio de Taylor]
Dada una función $f(x)$, $n$ veces derivable en un punto $a$, se llama \emph{polinomio de Taylor} de orden $n$ para $f$
en $a$, al polinomio
\[
P_{n,f,a}(x)=f(a)+f'(a)(x-a)+\frac{f''(a)}{2!}(x-a)^2+\cdots+\frac{f^{(n}(a)}{n!}(x-a)^n= \sum_{i=0}^{n}\frac{f^{(i}(a)}{i!}(x-a)^i.
\]
\end{definicion}

Este polinomio es el polinomio de grado menor o igual que $n$ que mejor aproxima a $f$ en un entorno del punto $a$, y
por tanto, si $x$ está próximo a $a$, $f(x)\approx P_{n,f,a}(x)$. 
Además, cuanto mayor es el grado del polinomio, mejor es la aproximación, tal y como se muestra en el ejemplo de la
figura~\ref{g:polinomios}.
\begin{figure}[h!]
\begin{center}
\scalebox{1}{\input{img/polinomios_taylor/polinomios_seno}}
\caption{Polinomios de Taylor de distintos grados para la función $\seno x$ en el punto 0.}
\label{g:polinomios}
\end{center}
\end{figure}

\subsubsection*{Polinomio de Mc Laurin}
Cuando nos interesa aproximar una función en un entorno del 0, la ecuación del polinomio de Taylor resulta especialmente simple:
\[
P_{n,f,0}(x)=f(0)+f'(0)x+\frac{f''(0)}{2!}x^2+\cdots+\frac{f^{(n}(0)}{n!}x^n= \sum_{i=0}^{n}\frac{f^{(i}(0)}{i!}x^i,
\]
y este polinomio se conoce como \emph{polinomio de Mc Laurin} de orden $n$ de $f$.

\subsubsection*{Resto de Taylor}
Los polinomios de Taylor nos permiten calcular el valor aproximado de una función en un entorno de un punto, pero normalmente el valor que proporciona el polinomio de Taylor difiere del valor real de la función, es decir, se comete un error en la aproximación. Dicho error se conoce como el \emph{resto de Taylor} de orden $n$ para $f$ en $a$, y es
\[
R_{n,f,a}(x)=f(x)-P_{n,f,a}(x).
\]

El resto mide el error cometido al aproximar $f(x)$ mediante $P_{n,f,a}(x)$ y nos permite expresar la función $f$ como la suma de un polinomio de Taylor más su resto correspondiente:
\[
f(x)=P_{n,f,a}(x)+R_{n,f,a}(x).
\]
Esta última expresión se conoce como \emph{fórmula de Taylor} de orden $n$ para $f$ en el punto $a$.

\subsubsection*{Forma de Lagrange del resto}
Normalmente, cuando se aproxima una función mediante un polinomio de Taylor, no se conoce el error cometido en la aproximación. No obstante, es posible acotar dicho error de acuerdo al siguiente teorema.

\begin{teorema}[Resto de Lagrange]
Sea $f$ una función para la que las $n+1$ primeras derivadas están definidas en el intervalo $[a,x]$. Entonces existe un
$t\in(a,x)$ tal que el resto de Taylor de orden $n$ para $f$ en el punto $a$ viene dado por
\[
R_{n,f,a}(x)=\frac{f^{(n+1}(t)}{(n+1)!}(x-a)^{n+1}.
\]
\end{teorema}
Esta expresión se conoce como \emph{forma de Lagrange del resto}.

Este teorema nos permite acotar el resto en valor absoluto, ya que una vez fijado el valor de $x$ donde queremos aproximar el valor de la función, el resto en la forma de Lagrange es una función que sólo depende de $t$. Puesto que $t\in (a,x)$, basta con encontrar el máximo del valor absoluto de esta función en dicho intervalo para tener una cota del error cometido.

\subsection{Polinomios de Taylor de funciones de varias variables}
Los polinomios de Taylor pueden generalizarse a funciones de más de una variable. Así, por ejemplo, si $f$ es un campo
escalar, el \emph{polinomio de Taylor} de primer grado de $f$ alrededor de un punto $a$ es
\begin{align*}
P^2_{f,a}(\mathbf{v})&=f(a)+\nabla f(a)\mathbf{v},
\end{align*}
y el de segundo grado es
\begin{align*}
P^2_{f,a}(\mathbf{v})&=f(a)+\nabla f(a)\mathbf{v}+\frac{1}{2}\mathbf{v}\nabla^2f(a)\mathbf{v}.
\end{align*}

Para el caso particular de funciones de dos variables $f(x,y$ y un punto $a=(x_0,y_0)$, 
\begin{multline*}
P^2_{f,a}(x,y) = f(a)+\frac{\partial f(a)}{\partial x}(x-x_0)+\frac{\partial f(a)}{\partial y}(y-y_0)+\\
+\frac{1}{2}\left(\frac{\partial^2 f(a)}{\partial x^2}(x-x_0)^2 + 2\frac{\partial^2 f(a)}{\partial y\partial x}
(x-x_0)(y-y_0) + \frac{\partial^2 f(a)}{\partial y^2}(y-y_0)^2\right)
\end{multline*}


\newpage

\section{Ejercicios resueltos}

\begin{enumerate}[leftmargin=*]
\item Calcular los polinomios de Taylor de la función $f(x)=\log x$ en el punto 1, hasta el grado 4 y representarlos junto a la función en
la misma gráfica.
¿Qué polinomio aproxima mejor a la función en un entorno del punto 1?

\begin{indication}
\begin{enumerate}
\item Definir la función introduciendo la expresión \command{f(x):=log(x)}. 
\item Hacer clic en el botón \button{Ventana 2D} para pasar a la venta gráfica 2D y hacer clic en el botón
\button{Representar expresión}.
\item Hacer clic en el botón  \button{Activar la ventana de algebra} para volver a la ventana de expresiones,
marcar el nombre de la función $f(x)$ y seleccionar el menú \menu{Cálculo > Polinomios de Taylor}.
\item En el cuadro que aparece, introducir $1$ en el campo \field{Punto}, introducir $1$ en el campo \field{Grado} y
hacer clic en el botón \button{Simplificar}.
\item Introducir la expresión \command{p1(x):=\$i}, donde \command{\$i} es la etiqueta correspondiente a la expresión
del polinomio de grado 1.\\
Nota: Un procedimiento más rápido para obtener el polinomio de grado uno es introducir directamente la expresión
\command{p1(x):=TAYLOR(f(x),x,1,1)}.
\item Hacer clic en el botón \button{Ventana 2D} para pasar a la venta gráfica 2D y hacer clic en el botón
\button{Representar expresión}.
\item Hacer clic en el botón \button{Activar la ventana de algebra} para volver a la ventana de expresiones, marcar la
expresión de la función $\log(x)$ y repetir el proceso anterior introduciendo sucesivamente 2, 3 y 4 como los grados del polinomio.
\end{enumerate}
\end{indication}

\item Dar el valor aproximado de $\log 1.2$ utilizando los polinomios del ejercicio anterior y calcular el error cometido en cada caso. 
Rellenar la siguiente tabla.
\[
\begin{tabular}{|c|c|c|c|}
\hline
Punto & Grado & Aproximación
& Error Cometido \\
\hline\hline
&  &  &  \\ \hline
&  &  &  \\ \hline
&  &  &  \\ \hline
&  &  &  \\ \hline
&  &  &  \\ \hline
\end{tabular}
\]

\begin{indication}
\begin{enumerate}
\item Introducir la expresión \command{p1(1.2)}.
\item Hacer clic en el botón \button{Aproximar} para obtener el valor aproximado de $\log(1.2)$ con el polinomio de grado
1. 
\item Introducir la expresión \command{ABS(p1(1.2)-f(1.2))}.
\item Hacer clic en el botón \button{Aproximar} para obtener el error comentido en la aproximación.
\item Repetir el procedimiento para cada uno de los polinomios calculados en el ejercicio anterior. 
\end{enumerate}
\end{indication}

\item Calcular el polinomio de Maclaurin de orden 3 para la función $\seno(x)$, y utilizarlo para aproximar el valor de
$\seno 1/2$.
Calcular el error cometido.

\begin{indication}
\begin{enumerate}
\item Definir la función introduciendo la expresión \command{f(x):=sin(x)}. 
\item Introducir la expresión \command{p3(x):=TAYLOR(f(x),x,0,3)}.
\item Hacer clic en el botón \button{Simplificar}.
\item Introducir la expresión \command{p3(1/2)}.
\item Hacer clic en el botón \button{Aproximar} para obtener la aproximación de $\seno(1/2)$ con el polinomio de Mc Laurin
de grado 3.
\item Introducir la expresión \command{ABS(p3(1/2)-f(1/2))}.
\item Hacer clic en el botón \button{Aproximar} para obtener el error en la aproximación.
\end{enumerate}
\end{indication}

\item Dada la función $f(x,y)=\sqrt{xy}$, se pide:
\begin{enumerate}
\item Definir la función y dibujar su gráfica.
\begin{indication}
\begin{enumerate}
\item Definir la función introduciendo la expresión \command{f(x,y):=sqrt(xy)}.
\item Hacer clic en el botón \button{Ventana 3D} para pasar a la ventana de representación de gráficas 3D.
\item Hacer clic en el botón \button{Representar}.
\end{enumerate}
\end{indication}

\item Calcular el polinomio de Taylor de primer grado de $f$ en el punto $(8,2)$ y representarlo gráficamente.
Comprobar que se obtiene el plano tangente a la superficie de $f$ en el punto $(8,2)$.
\begin{indication}
\begin{enumerate}
\item Introducir la expresión \command{[8,2,f(8,2)]}.
\item Hacer clic en el botón \button{Representar} de la ventana gráfica.
\item Introducir la expresión \command{p1(x,y):=f(8,2)+f'(8,2)[x-8,y-2]} y hacer clic en el botón \button{Simplificar}.
\item Hacer clic en el botón \button{Representar} de la ventana gráfica.
\end{enumerate}
\end{indication}

\item Utilizar el polinomio anterior para calcular el valor aproximado de $\sqrt{8.02\cdot 1.99}$.
\begin{indication}
\item Introducir la expresión \command{p1(8.02,1.99)} y hacer clic en el botón \button{Aproximar}.
\end{indication}

\item Calcular el error cometido en la aproximación anterior.
\begin{indication}
\item Introducir la expresión \command{abs(p1(8.02,1.99)-f(8.02,1.99))} y hacer clic en el botón \button{Aproximar}.
\end{indication}

\item Calcular el polinomio de Taylor de segundo grado de $f$ en el punto $(8,2)$ y representarlo gráficamente.
\begin{indication}
\begin{enumerate}
\item Introducir la expresión \command{p2(x,y):=p1(x,y)+1/2[x-8,y-2]f''(8,2)[x-8,y-2]} y hacer clic en el botón \button{Simplificar}.
\item Hacer clic en el botón \button{Representar} de la ventana gráfica.
\end{enumerate}
\end{indication}

\item Utilizar el polinomio anterior para calcular el valor aproximado de $\sqrt{8.02\cdot 1.99}$.
Comprobar que el error de la aproximación con el polinomio de Taylor de segundo grado es menor que el error de la aproximación con el polinomio de Taylor de primer grado. 
\begin{indication}
\item Introducir la expresión \command{p2(8.02,1.99)} y hacer clic en el botón \button{Aproximar}.
\end{indication}

\item Calcular el error cometido en la aproximación anterior.
\begin{indication}
\item Introducir la expresión \command{abs(p2(8.02,1.99)-f(8.02,1.99))} y hacer clic en el botón \button{Aproximar}.
\end{indication}
\end{enumerate}
\end{enumerate}


\section{Ejercicios propuestos}

\begin{enumerate}[leftmargin=*]
\item  Dada la función $f(x)=\sqrt{x+1}$ se pide:
\begin{enumerate}
\item  El polinomio de Taylor de cuarto grado de $f$ en $x=0$.

\item  Calcular un valor aproximado de $\sqrt{1.02}$ utilizando un polinomio de segundo grado y otro utilizando un
polinomio de cuarto grado. 
Dar una cota del error cometido en cada caso.
\end{enumerate}

\item Dadas las funciones
$f(x)=e^x$ y $g(x)=\cos x$, se pide:
\begin{enumerate}
\item  Calcular los polinomios de McLaurin de segundo grado para $f$ y $g$.

\item  Utilizar los polinomios anteriores para calcular \[ \lim_{x\rightarrow 0}\frac{e^x-\cos x}{x}.\]
\end{enumerate}

\item Calcular de manera aproximada el valor de $\log(0.09^3+0.99^3)$ usando:
\begin{enumerate}
\item Un polinomio de Taylor adecuado de primer orden.
\item Un polinomio de Taylor adecuado de segundo orden.
\end{enumerate}
\end{enumerate}
